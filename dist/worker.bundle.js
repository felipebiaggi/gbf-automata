(()=>{function e(o){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(o)}function o(e,o){for(var n=0;n<o.length;n++){var r=o[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,t(r.key),r)}}function t(o){var t=function(o){if("object"!=e(o)||!o)return o;var t=o[Symbol.toPrimitive];if(void 0!==t){var n=t.call(o,"string");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(o);return"symbol"==e(t)?t:t+""}var n=null,r=null,a=Object.freeze({INTERNAL:"INTERNAL",EXTERNAL:"EXTERNAL"}),c=Object.freeze({STOP:"STOP",MOVE:"MOVE",UPDATE:"UPDATE"}),s=function(){function e(o){var t=o.message_type,n=o.message_action,r=o.extra;!function(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this,e),this.messageType=t,this.messageAction=n,this.extra=r}return t=e,n=[{key:"fromJson",value:function(o){try{var t=JSON.parse(o);if(!Object.values(a).includes(t.message_type))throw new Error("Invalid message_type: ".concat(t.message_type));if(!Object.values(c).includes(t.message_action))throw new Error("Invalid message_action: ".concat(t.message_action));return new e(t)}catch(e){throw new Error("Invalid JSON format.")}}}],null&&o(t.prototype,null),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n}();chrome.runtime.onMessage.addListener((function(e,o,t){n&&n.readyState===WebSocket.OPEN||(n&&n.readyState!==WebSocket.CLOSED?console.log("WebSocket jÃ¡ conectado."):((n=new WebSocket("ws://localhost:12000")).onopen=function(){console.log("Connection Open."),r||(r=setInterval((function(){n&&n.readyState===WebSocket.OPEN?n.send("keepalive"):(clearInterval(r),r=null)}),5e3))},n.onclose=function(){console.log("Connection Closed."),n=null},n.onmessage=function(e){var o=s.fromJson(e.data);console.log("WebSocket received message:",o),o.messageAction===c.MOVE&&(console.log("ACTION.MOVE"),chrome.tabs.update({url:o.extra}))})),["none","block"].includes(e.message)&&n.send(e.message),console.log(e.message)}))})();